<div class="card">
    <h3>Görsel Yükle ve Yansıt</h3>
    <input type="text" id="screenId" placeholder="Ekran Kimliği (Örn: salon1)">
    
    <label for="fileInput" style="display:block; margin-top:10px; font-size:12px; color:#888;">Görsel Seç (JPG, PNG, JPEG):</label>
    <input type="file" id="fileInput" accept="image/*">
    
    <button id="uploadBtn" onclick="uploadAndSend()" style="margin-top:15px; background:#28a745">Görseli Yükle ve TV'ye Gönder</button>
    <div id="uploadStatus" style="font-size:12px; margin-top:5px; color:#ffcc00"></div>
</div>

<script>
async function uploadAndSend() {
    const screenId = document.getElementById('screenId').value;
    const fileInput = document.getElementById('fileInput');
    const status = document.getElementById('uploadStatus');
    const btn = document.getElementById('uploadBtn');

    if(!screenId || !fileInput.files[0]) return alert("Lütfen ID girin ve bir dosya seçin!");

    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    formData.append('screenId', screenId);

    btn.disabled = true;
    status.innerText = "Yükleniyor...";

    try {
        const response = await fetch('/upload', {
            method: 'POST',
            body: formData
        });
        
        if(response.ok) {
            status.innerText = "Başarıyla yüklendi ve yansıtıldı!";
            fileInput.value = ""; // Seçimi temizle
        }
    } catch (err) {
        status.innerText = "Yükleme hatası!";
    } finally {
        btn.disabled = false;
    }
}
</script>
